@echo off
chcp 65001 >nul
setlocal

:: Устанавливаем лог-файл
set "LOGFILE=%~dp0MoveMods.log"

:: Очистка лога при каждом запуске
echo. > "%LOGFILE%"

:: Очищаем экран и выводим ASCII-арт
cls
echo ███╗   ██╗███████╗██╗  ██╗ ██████╗ ███╗   ██╗    ██████╗ ██████╗  ██████╗      ██╗███████╗ ██████╗████████╗
echo ████╗  ██║██╔════╝╚██╗██╔╝██╔═══██╗████╗  ██║    ██╔══██╗██╔══██╗██╔═══██╗     ██║██╔════╝██╔════╝╚══██╔══╝
echo ██╔██╗ ██║█████╗   ╚███╔╝ ██║   ██║██╔██╗ ██║    ██████╔╝██████╔╝██║   ██║     ██║█████╗  ██║        ██║   
echo ██║╚██╗██║██╔══╝   ██╔██╗ ██║   ██║██║╚██╗██║    ██╔═══╝ ██╔══██╗██║   ██║██   ██║██╔══╝  ██║        ██║   
echo ██║ ╚████║███████╗██╔╝ ██╗╚██████╔╝██║ ╚████║    ██║     ██║  ██║╚██████╔╝╚█████╔╝███████╗╚██████╗   ██║   
echo ╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝ ╚═════╝ ╚═╝  ╚═══╝    ╚═╝     ╚═╝  ╚═╝ ╚═════╝  ╚════╝ ╚══════╝ ╚═════╝   ╚═╝   
echo ========================================================
echo          КОПИРОВАНИЕ МОДОВ В .minecraft                  
echo ========================================================

:: Проверка, запущен ли Minecraft
echo Проверка, запущен ли Minecraft...
tasklist | find /i "javaw.exe" >nul
if %errorlevel%==0 (
    echo ============================================
    echo Ошибка: Minecraft запущен! Закройте игру перед установкой модов.
    echo ============================================
    echo [%date% %time%] ОШИБКА: Minecraft запущен. Копирование отменено. >> "%LOGFILE%"
    pause
    exit /b
)

:: Записываем дату и время в лог
echo [%date% %time%] Запуск скрипта. >> "%LOGFILE%"

:: Настройка путей
set "BASENAME=QuarionMods\mods"
set "SOURCE=%~dp0%BASENAME%"
set "DESTINATION=%APPDATA%\.minecraft\mods"

:: Проверяем существование исходной папки
if not exist "%SOURCE%" (
    echo Ошибка: папка с модами не найдена!
    echo Проверьте путь: %SOURCE%
    echo [%date% %time%] Ошибка: папка с модами не найдена! >> "%LOGFILE%"
    pause
    exit /b
)

:: Проверяем или создаем папку назначения
if not exist "%DESTINATION%" mkdir "%DESTINATION%"

:: Копирование файлов
echo Копирование файлов...
xcopy /Y /E "%SOURCE%\*" "%DESTINATION%" >nul

:: Проверяем результат копирования
if %errorlevel% neq 0 (
    echo Ошибка при копировании файлов!
    echo [%date% %time%] Ошибка при копировании файлов! >> "%LOGFILE%"
    pause
    exit /b
)

:: Вывод информации об успешном копировании
echo ========================================================
echo Операция завершена успешно!
echo Файлы скопированы из: %SOURCE%
echo В: %DESTINATION%
echo ========================================================

:: Записываем в лог успешное завершение
echo [%date% %time%] Операция завершена успешно. >> "%LOGFILE%"

:: Остановка перед закрытием
pause
